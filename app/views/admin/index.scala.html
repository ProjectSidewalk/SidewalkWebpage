@import models.user.User
@import models.daos.slick._
@import models.audit._
@import models.label._
@import models.audit.AuditTaskCommentTable
@import models.utils.DataFormatter

@import models.user.OrganizationTable
@(title: String, user: Option[User] = None)(implicit lang: Lang)
@main(title) {
    @navbar(user, Some("/admin"))
    <style>
        .no-js #loader { display: none;  }
        .js #loader { display: block; position: absolute; left: 100px; top: 0; }
        .loader {
            position: fixed;
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            z-index: 9999;
            background: url('/assets/images/project_sidewalk_page_load.gif') center no-repeat #fff ;
        }
    </style>
    <div class="loader"></div>
    <div class="container">
        <div id="row">
            <div class="col-lg-2">
            <ul class="nav nav-pills nav-stacked">
                <li class="active"><a href="#tabs-1"data-toggle="pill" id="overview">Overview</a></li>
                <li><a href="#tabs-2" data-toggle="pill" id="visualization">Map</a></li>
                <li><a href="#tabs-3" data-toggle="pill" id="analytics">Analytics</a></li>
                <li><a href="#tabs-4" data-toggle="pill" id="contributions">Contributions</a></li>
                <li><a href="#tabs-5" data-toggle="pill" id="users">Users</a></li>
                <li><a href="#tabs-6" data-toggle="pill" id="label-search">Label Search</a></li>
                <li><a href="#tabs-7" data-toggle="pill" id="teams-tab">Teams</a></li>
            </ul>
            </div>                           
            <div class="col-lg-10">
                <div class="tab-content">
                <div class="tab-pane active" id="tabs-1">
                    <div class="row">
                        <div class="col-lg-6">
                            <h1>Activities</h1>
                            Today and Past Week are based on the Pacific time zone.
                            <table class="table table-striped table-condensed">
                                <tr>
                                    <th></th>
                                    <th>Overall<sup>*</sup></th>
                                    <th>Today</th>
                                    <th>Past Week</th>
                                </tr>
                                <tr>
                                    <th>Total Users</th>
                                    <th>@UserDAOSlick.countAllUsersContributed("all time", false, false) (@UserDAOSlick.countAllUsersContributed("all time", true, false))</th>
                                    <th>@UserDAOSlick.countAllUsersContributed("today", false, false) (@UserDAOSlick.countAllUsersContributed("today", true, false))</th>
                                    <th>@UserDAOSlick.countAllUsersContributed("week", false, false) (@UserDAOSlick.countAllUsersContributed("week", true, false))</th>
                                </tr>
                                <tr>
                                    <th>Total Auditing Time</th>
                                    <th>@{AuditTaskInteractionTable.calculateTimeAuditing("all time").map(value => f"$value%.2f hr").getOrElse("NA")}</th>
                                    <th>@{AuditTaskInteractionTable.calculateTimeAuditing("today").map(value => f"$value%.2f hr").getOrElse("NA")}</th>
                                    <th>@{AuditTaskInteractionTable.calculateTimeAuditing("week").map(value => f"$value%.2f hr").getOrElse("NA")}</th>
                                </tr>
                                </tr>
                                <tr>
                                    <th>Total Validating Time</th>
                                    <th>@{AuditTaskInteractionTable.calculateTimeValidating("all time").map(value => f"$value%.2f hr").getOrElse("NA")}</th>
                                    <th>@{AuditTaskInteractionTable.calculateTimeValidating("today").map(value => f"$value%.2f hr").getOrElse("NA")}</th>
                                    <th>@{AuditTaskInteractionTable.calculateTimeValidating("week").map(value => f"$value%.2f hr").getOrElse("NA")}</th>
                                </tr>
                                <tr>
                                    <th>Avg Auditing Time / 100m </th>
                                    <th>@{AuditTaskInteractionTable.calculateMedianAuditingTime("all time").map(value => f"$value%.2f min").getOrElse("NA")}</th>
                                    <th>@{AuditTaskInteractionTable.calculateMedianAuditingTime("today").map(value => f"$value%.2f min").getOrElse("NA")}</th>
                                    <th>@{AuditTaskInteractionTable.calculateMedianAuditingTime("week").map(value => f"$value%.2f min").getOrElse("NA")}</th>
                                </tr>
                                <tr>
                                    <th>Total Users (High Quality)</th>
                                    <th>@UserDAOSlick.countAllUsersContributed("all time", false, true) (@UserDAOSlick.countAllUsersContributed("all time", true, true))</th>
                                    <th>@UserDAOSlick.countAllUsersContributed("today", false, true) (@UserDAOSlick.countAllUsersContributed("today", true, true))</th>
                                    <th>@UserDAOSlick.countAllUsersContributed("week", false, true) (@UserDAOSlick.countAllUsersContributed("week", true, true))</th>
                                </tr>
                                <tr>
                                    <th>Total Explore Users</th>
                                    <th>@UserDAOSlick.countAllAuditUsersContributed(false) (@UserDAOSlick.countAllAuditUsersContributed(true))</th>
                                    <th>@UserDAOSlick.countAllAuditUsersContributedToday</th>
                                    <th>@UserDAOSlick.countAllAuditUsersContributedPastWeek</th>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Registered</td>
                                    <td>@UserDAOSlick.countAuditUsersContributed(List("Registered"), false) (@UserDAOSlick.countAuditUsersContributed(List("Registered"), true))</td>
                                    <td>@UserDAOSlick.countAuditUsersContributedToday("Registered")</td>
                                    <td>@UserDAOSlick.countAuditUsersContributedPastWeek("Registered")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Anonymous</td>
                                    <td>@UserDAOSlick.countAuditUsersContributed(List("Anonymous"), false) (@UserDAOSlick.countAuditUsersContributed(List("Anonymous"), true))</td>
                                    <td>@UserDAOSlick.countAuditUsersContributedToday("Anonymous")</td>
                                    <td>@UserDAOSlick.countAuditUsersContributedPastWeek("Anonymous")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Turkers</td>
                                    <td>@UserDAOSlick.countAuditUsersContributed(List("Turker"), false) (@UserDAOSlick.countAuditUsersContributed(List("Turker"), true))</td>
                                    <td>@UserDAOSlick.countAuditUsersContributedToday("Turker")</td>
                                    <td>@UserDAOSlick.countAuditUsersContributedPastWeek("Turker")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Researchers</td>
                                    <td>@UserDAOSlick.countAuditResearchersContributed(false) (@UserDAOSlick.countAuditResearchersContributed(true))</td>
                                    <td>@UserDAOSlick.countAuditResearchersContributedToday</td>
                                    <td>@UserDAOSlick.countAuditResearchersContributedPastWeek</td>
                                </tr>

                                <tr>
                                    <th>Total Labels</th>
                                    <th>@LabelTable.countLabels</th>
                                    <th>@LabelTable.countTodayLabels</th>
                                    <th>@LabelTable.countPastWeekLabels</th>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("curb.ramp")</td>
                                    <td>@LabelTable.countLabels("CurbRamp")</td>
                                    <td>@LabelTable.countTodayLabels("CurbRamp")</td>
                                    <td>@LabelTable.countPastWeekLabels("CurbRamp")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("missing.ramp")</td>
                                    <td>@LabelTable.countLabels("NoCurbRamp")</td>
                                    <td>@LabelTable.countTodayLabels("NoCurbRamp")</td>
                                    <td>@LabelTable.countPastWeekLabels("NoCurbRamp")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("obstacle")</td>
                                    <td>@LabelTable.countLabels("Obstacle")</td>
                                    <td>@LabelTable.countTodayLabels("Obstacle")</td>
                                    <td>@LabelTable.countPastWeekLabels("Obstacle")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("surface.problem")</td>
                                    <td>@LabelTable.countLabels("SurfaceProblem")</td>
                                    <td>@LabelTable.countTodayLabels("SurfaceProblem")</td>
                                    <td>@LabelTable.countPastWeekLabels("SurfaceProblem")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("no.sidewalk")</td>
                                    <td>@LabelTable.countLabels("NoSidewalk")</td>
                                    <td>@LabelTable.countTodayLabels("NoSidewalk")</td>
                                    <td>@LabelTable.countPastWeekLabels("NoSidewalk")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("crosswalk")</td>
                                    <td>@LabelTable.countLabels("Crosswalk")</td>
                                    <td>@LabelTable.countTodayLabels("Crosswalk")</td>
                                    <td>@LabelTable.countPastWeekLabels("Crosswalk")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("signal")</td>
                                    <td>@LabelTable.countLabels("Signal")</td>
                                    <td>@LabelTable.countTodayLabels("Signal")</td>
                                    <td>@LabelTable.countPastWeekLabels("Signal")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("other")</td>
                                    <td>@LabelTable.countLabels("Other")</td>
                                    <td>@LabelTable.countTodayLabels("Other")</td>
                                    <td>@LabelTable.countPastWeekLabels("Other")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("occlusion")</td>
                                    <td>@LabelTable.countLabels("Occlusion")</td>
                                    <td>@LabelTable.countTodayLabels("Occlusion")</td>
                                    <td>@LabelTable.countPastWeekLabels("Occlusion")</td>
                                </tr>

                                <tr>
                                    <th>Audits</th>
                                    <th>@AuditTaskTable.countCompletedAudits</th>
                                    <th>@AuditTaskTable.countCompletedAuditsToday</th>
                                    <th>@AuditTaskTable.countCompletedAuditsPastWeek</th>
                                </tr>
                                <tr>
                                    <th>Audited Distance</th>
                                    <th><span id="audited-distance-all-time"></span></th>
                                    <th><span id="audited-distance-today"></span></th>
                                    <th><span id="audited-distance-week"></span></th>
                                </tr>
                                <tr>
                                    <th>Total Validation Users</th>
                                    <th>@UserDAOSlick.countAllValidationUsersContributed(false) (@UserDAOSlick.countAllValidationUsersContributed(true))</th>
                                    <th>@UserDAOSlick.countAllValidationUsersContributedToday</th>
                                    <th>@UserDAOSlick.countAllValidationUsersContributedPastWeek</th>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Registered</td>
                                    <td>@UserDAOSlick.countValidationUsersContributed(List("Registered"), false) (@UserDAOSlick.countValidationUsersContributed(List("Registered"), true))</td>
                                    <td>@UserDAOSlick.countValidationUsersContributedToday("Registered")</td>
                                    <td>@UserDAOSlick.countValidationUsersContributedPastWeek("Registered")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Anonymous</td>
                                    <td>@UserDAOSlick.countValidationUsersContributed(List("Anonymous"), false) (@UserDAOSlick.countValidationUsersContributed(List("Anonymous"), true))</td>
                                    <td>@UserDAOSlick.countValidationUsersContributedToday("Anonymous")</td>
                                    <td>@UserDAOSlick.countValidationUsersContributedPastWeek("Anonymous")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Turkers</td>
                                    <td>@UserDAOSlick.countValidationUsersContributed(List("Turker"), false) (@UserDAOSlick.countValidationUsersContributed(List("Turker"), true))</td>
                                    <td>@UserDAOSlick.countValidationUsersContributedToday("Turker")</td>
                                    <td>@UserDAOSlick.countValidationUsersContributedPastWeek("Turker")</td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Researchers</td>
                                    <td>@UserDAOSlick.countValidationResearchersContributed(false) (@UserDAOSlick.countValidationResearchersContributed(true))</td>
                                    <td>@UserDAOSlick.countValidationResearchersContributedToday</td>
                                    <td>@UserDAOSlick.countValidationResearchersContributedPastWeek</td>
                                </tr>

                                <tr style="font-size: 90%;">
                                    <th>Total Validations</th>
                                    <th>@LabelValidationTable.countValidations</th>
                                    <th>@LabelValidationTable.countTodayValidations</th>
                                    <th>@LabelValidationTable.countPastWeekValidations</th>
                                </tr>

                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Agreed</td>
                                    <td>@LabelValidationTable.countValidationsByResult(1) (@("%.0f".format(LabelValidationTable.countValidationsByResult(1) * 100.0 / LabelValidationTable.countValidations))%)</td>
                                    <td>@LabelValidationTable.countTodayValidationsByResult(1) (@("%.0f".format(LabelValidationTable.countTodayValidationsByResult(1) * 100.0 / LabelValidationTable.countTodayValidations))%)</td>
                                    <td>@LabelValidationTable.countPastWeekValidationsByResult(1) (@("%.0f".format(LabelValidationTable.countPastWeekValidationsByResult(1) * 100.0 / LabelValidationTable.countPastWeekValidations))%)</td>
                                </tr>

                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Disagreed</td>
                                    <td>@LabelValidationTable.countValidationsByResult(2) (@("%.0f".format(LabelValidationTable.countValidationsByResult(2) * 100.0 / LabelValidationTable.countValidations))%)</td>
                                    <td>@LabelValidationTable.countTodayValidationsByResult(2) (@("%.0f".format(LabelValidationTable.countTodayValidationsByResult(2) * 100.0 / LabelValidationTable.countTodayValidations))%)</td>
                                    <td>@LabelValidationTable.countPastWeekValidationsByResult(2) (@("%.0f".format(LabelValidationTable.countPastWeekValidationsByResult(2) * 100.0 / LabelValidationTable.countPastWeekValidations))%)</td>
                                </tr>

                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">@Messages("unsure.caps")</td>
                                    <td>@LabelValidationTable.countValidationsByResult(3) (@("%.0f".format(LabelValidationTable.countValidationsByResult(3) * 100.0 / LabelValidationTable.countValidations))%)</td>
                                    <td>@LabelValidationTable.countTodayValidationsByResult(3) (@("%.0f".format(LabelValidationTable.countTodayValidationsByResult(3) * 100.0 / LabelValidationTable.countTodayValidations))%)</td>
                                    <td>@LabelValidationTable.countPastWeekValidationsByResult(3) (@("%.0f".format(LabelValidationTable.countPastWeekValidationsByResult(3) * 100.0 / LabelValidationTable.countPastWeekValidations))%)</td>
                                </tr>
                            </table>
                            <sup>*</sup>For cells with the format X (Y). The "Y" is the number of users who have completed
                            at least 1 audit task or have validated at least one label. The X is the total number of users
                            who opened the audit or validation tool regardless of finishing a task.
                        </div>
                        <div class="col-lg-6">
                            <h1>Coverage</h1>
                            <table class="table table-striped table-condensed w-auto">
                                <tr>
                                    <th></th>
                                    <th>All Users</th>
                                    <th>High Quality</th>
                                    <th>Total</th>
                                </tr>
                                <tr>
                                    <th>Audited Streets</th>
                                    <td><span id="street-count-audited-all"></span></td>
                                    <td><span id="street-count-audited-high-quality"></span></td>
                                    <td><span id="street-count-total"></span></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Registered</td>
                                    <td><span id="street-count-audited-registered-all"></span></td>
                                    <td><span id="street-count-audited-registered-high-quality"></span></td>
                                    <td></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Anonymous</td>
                                    <td><span id="street-count-audited-anonymous-all"></span></td>
                                    <td><span id="street-count-audited-anonymous-high-quality"></span></td>
                                    <td></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Turker</td>
                                    <td><span id="street-count-audited-turker-all"></span></td>
                                    <td><span id="street-count-audited-turker-high-quality"></span></td>
                                    <td></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Researcher</td>
                                    <td><span id="street-count-audited-researcher-all"></span></td>
                                    <td><span id="street-count-audited-researcher-high-quality"></span></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <th>Distance</th>
                                    <td><span id="street-distance-audited-all"></span></td>
                                    <td><span id="street-distance-audited-high-quality"></span></td>
                                    <td><span id="street-distance-total"></span></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Registered</td>
                                    <td><span id="street-distance-registered-all"></span></td>
                                    <td><span id="street-distance-registered-high-quality"></span></td>
                                    <td></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Anonymous</td>
                                    <td><span id="street-distance-anonymous-all"></span></td>
                                    <td><span id="street-distance-anonymous-high-quality"></span></td>
                                    <td></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Turker</td>
                                    <td><span id="street-distance-turker-all"></span></td>
                                    <td><span id="street-distance-turker-high-quality"></span></td>
                                    <td></td>
                                </tr>
                                <tr style="font-size: 90%;">
                                    <td style="padding-left: 30px">Researcher</td>
                                    <td><span id="street-distance-researcher-all"></span></td>
                                    <td><span id="street-distance-researcher-high-quality"></span></td>
                                    <td></td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-lg-4">
                            <h1></h1>

                        </div>
                        <button onclick="admin.clearPlayCache()">@Messages("admin.clear.play.cache")</button>
                        <p id="clearPlayCacheSuccess" style="color:green"></p>
                    </div>
                    <div class="row">
                        <h1>Comments</h1>
                        <div class="col-lg-12">
                            <p>Last 100 comments</p>
                            <table id="comments-table" data-order='[[ 1, "desc" ]]'
                                class="table table-striped table-condensed">
                                <thead>
                                <tr>
                                    <th class="col-md-2">Username</th>
                                    <th class="col-md-3" data-class-name="priority">Timestamp</th>
                                    <th class="col-md-2">Panorama Id</th>
                                    <th class="col-md-1">Interface</th>
                                    <th class="col-md-4">Comment</th>
                                </tr>
                                </thead>
                                <tbody>
                                @AuditTaskCommentTable.takeRightAuditAndValidationComments(100).map { comment =>
                                <tr>
                                    <td><a href='@routes.AdminController.userProfile(comment.username)'>@comment.username</a>
                                    </td>
                                    <td class = 'timestamp'>@comment.timestamp</td>
                                    <td>
                                        <a class="show-comment-location" href="#"
                                        data-heading="@comment.heading" data-pitch="@comment.pitch" data-zoom="@comment.zoom" data-label-id="@comment.labelId">@comment.gsvPanoramaId</a>
                                    </td>
                                    <td>@comment.commentType</td>
                                    <td>@comment.comment</td>
                                </tr>
                                }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="tabs-2" class="tab-pane">
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="admin-labelmap-choropleth-holder" class="choropleth-holder">
                                <div id="admin-labelmap-choropleth" class="choropleth"></div>
                                <div id="map-label-legend">
                                    <div id="map-legend-title-holder">
                                        <label id="map-legend-title">@Messages("legend")</label>
                                        <button id="map-legend-minimize-button" class="close" onclick="toggleLegend()">-</button>
                                    </div>
                                    <table class="table filter" id="legend-table">
                                        <tr>
                                            <td></td>
                                            <td colspan="2" align="left" style="font-weight:bold">@Messages("label.type")</td>
                                            <td colspan="2" align="left" style="font-weight:bold">@Messages("severity")</td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-curb-ramp" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td width="190px">@Messages("curb.ramp")</td>
                                            <td width="12px"  align="center"><input type="checkbox" id="CurbRamp-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                            <td width="113px"align="center"><div id = "CurbRamp-slider" style="margin-top:3px"></div></td>
                                            <td width="93px" align= "center" ><span id="CurbRamp-severity-label">@Messages("not.applicable.abbr") - 5</span></td>

                                        </tr>
                                        <tr>
                                            <td id="map-legend-no-curb-ramp" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("missing.ramp")</td>
                                            <td><input type="checkbox" id="NoCurbRamp-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                            <td align="left"><div id = "NoCurbRamp-ramp-slider" style="margin-top:3px"></div></td>
                                            <td align= "center"><span id="NoCurbRamp-ramp-severity-label">@Messages("not.applicable.abbr") - 5</span></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-obstacle" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("obstacle")</td>
                                            <td><input type="checkbox" id="Obstacle-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                            <td align="left"><div id = "Obstacle-slider" style="margin-top:3px"></div></td>
                                            <td align= "center"><span id="Obstacle-severity-label">@Messages("not.applicable.abbr") - 5</span></td>
                                        </tr>
                                        <tr><td id="map-legend-surface-problem" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("surface.problem")</td>
                                            <td><input type="checkbox" id="SurfaceProblem-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                            <td align="left"><div id = "SurfaceProblem-slider" style="margin-top:3px"></div></td>
                                            <td align="center"><span id="SurfaceProblem-severity-label">@Messages("not.applicable.abbr") - 5</span></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-crosswalk" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("crosswalk")</td>
                                            <td><input type="checkbox" id="Crosswalk-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                            <td align="left"><div id = "Crosswalk-slider" style="margin-top:3px"></div></td>
                                            <td align="center"><span id="Crosswalk-severity-label">@Messages("not.applicable.abbr") - 5</span></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-no-sidewalk" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("no.sidewalk")</td>
                                            <td><input type="checkbox" id="NoSidewalk-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                            <td align="left"><div id = "NoSidewalk-slider" style="margin-top:3px"></div></td>
                                            <td align="center"><span id="NoSidewalk-severity-label">@Messages("not.applicable.abbr") - 5</span></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-other" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("other")</td>
                                            <td><input type="checkbox" id="Other-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                            <td align="left"><div id = "Other-slider" style="margin-top:3px"></div></td>
                                            <td align= "center"><span id="Other-severity-label">@Messages("not.applicable.abbr") - 5</span></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-signal" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("signal")</td>
                                            <td><input type="checkbox" id="Signal-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-occlusion" class="map-legend-circle-icon"><svg><circle r='6'/></svg></td>
                                            <td>@Messages("occlusion")</td>
                                            <td><input type="checkbox" id="Occlusion-checkbox" checked="true" data-filter-type="label-type" disabled></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-correct"><img src='@routes.Assets.at("javascripts/SVValidate/img/Checkmark.png")'></td>
                                            <td>@Messages("validated.correct")</td>
                                            <td><input type="checkbox" id="correct" checked="true" data-filter-type="label-validations" disabled></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-incorrect"><img src='@routes.Assets.at("javascripts/SVValidate/img/Cross.png")'></td>
                                            <td>@Messages("validated.incorrect")</td>
                                            <td><input type="checkbox" id="incorrect" data-filter-type="label-validations" disabled></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-unsure"><img src='@routes.Assets.at("images/icons/QuestionMark.png")'></td>
                                            <td>@Messages("unsure.caps")</td>
                                            <td><input type="checkbox" id="unsure" checked="true" data-filter-type="label-validations" disabled></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-unvalidated"><img src='@routes.Assets.at("images/icons/ExclamationMark.png")'></td>
                                            <td>@Messages("unvalidated")</td>
                                            <td><input type="checkbox" id="unvalidated" checked="true" data-filter-type="label-validations" disabled></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-audited-street"><svg><path d="M 2 10 L 18 10 z"></path></svg></td>
                                            <td>@Messages("audited.street")</td>
                                            <td><input type="checkbox" id="auditedstreet" checked="true" data-filter-type="streets" disabled></td>
                                        </tr>
                                        <tr>
                                            <td id="map-legend-unaudited-street"><svg><path d="M 2 10 L 18 10 z"></path></svg></td>
                                            <td>@Messages("unaudited.street")</td>
                                            <td><input type="checkbox" id="unauditedstreet" checked="true" data-filter-type="streets" disabled></td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="tabs-3" class="tab-pane">
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="admin-landing-choropleth-holder" class="choropleth-holder">
                                <div id="admin-landing-choropleth" class="choropleth"></div>
                                <div id="admin-percentage-legend">
                                    <strong>Percent of Neighborhood Complete</strong>
                                    <nav class='legend clearfix'>
                                        <span style='background:#03152f;width:9.09%'></span>
                                        <span style='background:#08306b;width:9.09%'></span>
                                        <span style='background:#08519c;width:9.09%'></span>
                                        <span style='background:#08719c;width:9.09%'></span>
                                        <span style='background:#2171b5;width:9.09%'></span>
                                        <span style='background:#4292c6;width:9.09%'></span>
                                        <span style='background:#6baed6;width:9.09%'></span>
                                        <span style='background:#82badb;width:9.09%'></span>
                                        <span style='background:#9ecae1;width:9.09%'></span>
                                        <span style='background:#b3d3e8;width:9.09%'></span>
                                        <span style='background:#c6dbef;width:9.09%'></span>
                                         <div id="legend-percentages-container">
                                            <label style='text-align: left'>0%</label>
                                            <label style='text-align: right'>100%</label>
                                        </div>
                                    </nav>
                                </div>
                            </div>
                        </div>

                        <h2>Coverage Percentage by Neighborhood</h2>
                        <div class="col-lg-12">
                            <div id="neighborhood-completion-rate"></div>
                        </div>
                        <button id="neighborhood-completion-sort-button">Sort By Completion %</button>
                        <button id="neighborhood-alphabetical-sort-button">Sort Alphabetically</button>
                        <h2>Neighborhood Coverage Percentages</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation: </span><span id="neighborhood-std"></span><br>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="neighborhood-completed-distance"></div>
                        </div>

                        <h2 style="...">City Coverage Progress</h2>
                        <div class="col-lg-12">
                            <div id="completion-progress-chart"></div>
                        </div>

                        <h2>Daily Audits</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation: </span><span id="audit-std"></span><br>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="audit-count-chart"></div>
                        </div>

                        <h2>Daily Label Counts</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation: </span><span id="label-std"></span><br>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="label-count-chart"></div>
                        </div>

                        <h2>Severity Ratings by Label Type</h2>
                        <div class="col-lg-12">
                            <div class="stats-grid">
                                <p>
                                    <span>Average (curb ramp): </span><span id="curb-ramp-mean"></span><br>
                                    <span>Average (missing curb ramp): </span><span id="missing-ramp-mean"></span><br>
                                    <span>Average (obstacle): </span><span id="obstacle-mean"></span><br>
                                    <span>Average (surface problem): </span><span id="surface-mean"></span><br>
                                    <span>Average (no sidewalk): </span><span id="no-sidewalk-mean"></span><br>
                                    <span>Average (crosswalk): </span><span id="crosswalk-mean"></span><br>
                                    <span>Average (all label types): </span><span id="labels-mean"></span><br>
                                </p>
                                <p>
                                    <span>Standard Deviation (curb ramp): </span><span id="curb-ramp-std"></span><br>
                                    <span>Standard Deviation (missing curb ramp): </span><span id="missing-ramp-std"></span><br>
                                    <span>Standard Deviation (obstacle): </span><span id="obstacle-std"></span><br>
                                    <span>Standard Deviation (surface problem): </span><span id="surface-std"></span><br>
                                    <span>Standard Deviation (no sidewalk): </span><span id="no-sidewalk-std"></span><br>
                                    <span>Standard Deviation (crosswalk): </span><span id="crosswalk-std"></span><br>
                                    <span>Standard Deviation (all label types): </span><span id="labels-std"></span><br>
                                </p>
                            </div>

                            <div id="severity-histograms"></div>
                            <div id="severity-histograms2"></div>
                        </div>

                        <h2>Missions Completed By Users</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation (all users): </span><span id="missions-std"></span><br>
                                <span>Standard Deviation (turker users): </span><span id="turker-missions-std"></span><br>
                                <span>Standard Deviation (registered users): </span><span id="reg-missions-std"></span><br>
                                <span>Standard Deviation (anon users): </span><span id="anon-missions-std"></span><br>
                                <span>
                                    Note: We only consider anonymous users who have completed at least one audit task.
                                </span>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="mission-count-chart"></div>
                        </div>
                        <label><input type="checkbox" id="mission-count-include-researchers-checkbox"> Include researchers</label>

                        <h2>Labels per User</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation (all users): </span><span id="all-labels-std"></span><br>
                                <span>Standard Deviation (turker users): </span><span id="turker-labels-std"></span><br>
                                <span>Standard Deviation (registered users): </span><span id="reg-labels-std"></span><br>
                                <span>Standard Deviation (anon users): </span><span id="anon-labels-std"></span><br>
                                <span>
                                    Note: We only consider anonymous users who have completed at least one audit task.
                                </span>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="label-count-hist"></div>
                        </div>
                        <label><input type="checkbox" id="label-count-include-researchers-checkbox"> Include researchers</label>

                        <h2>Logins Per User</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation: </span><span id="login-count-std"></span><br>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="login-count-chart"></div>
                        </div>
                        <label><input type="checkbox" id="login-count-include-researchers-checkbox"> Include researchers</label>

                        <h2>How users access Explore Page from Landing Page:</h2>
                        <div class="col-lg-12 col-md-4" style="align:left">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th style="text-align: right;">Activity</th>
                                        <th style="text-align: right;">Number</th>
                                        <th style="text-align: right;">Percentage of ExploreVisitors(%)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr id="audit-access-table-start-main">
                                        <td style="text-align: right;">Click <i>Start Exploring (Main)</i></td>
                                    </tr>
                                    <tr id="audit-access-table-start-nav">
                                        <td style="text-align: right;">Click <i>Start Exploring (Navbar)</i></td>
                                    </tr>
                                    <tr id="audit-access-table-choro">
                                        <td style="text-align: right;">Click Via Choropleth</td>
                                    </tr>
                                    <tr id="audit-access-table-turker">
                                        <td style="text-align: right;">Turker Redirect</td>
                                    </tr>
                                    <tr id="audit-access-table-total">
                                        <td style="text-align: right;">Total <i>(Visit Audit)</i></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h2 class="d-block">User Performance (validation agreement)</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation: </span><span id="validation-agreed-std"></span><br>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="validation-agreed"></div>
                        </div>

                        <h2>Daily Validation Counts</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation: </span><span id="validation-std"></span><br>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="validation-count-chart"></div>
                        </div>

                        <h2># Own Labels Validated per User</h2>
                        <div class="col-lg-12">
                            <p>
                                <span>Standard Deviation (all users): </span><span id="all-validation-std"></span><br>
                                <span>Standard Deviation (turker users): </span><span id="turker-validation-std"></span><br>
                                <span>Standard Deviation (registered users): </span><span id="reg-validation-std"></span><br>
                                <span>Standard Deviation (anon users): </span><span id="anon-validation-std"></span><br>
                            </p>
                        </div>
                        <div class="col-lg-12">
                            <div id="validation-count-hist"></div>
                        </div>
                        <label><input type="checkbox" id="validation-count-include-researchers-checkbox"> Include researchers</label>

                        <div class="row">
                            <div class="col-lg-23">
                                <h1>Validations Per Label Type</h1>
                                <table class="table table-striped table-condensed">
                                    <tr>
                                        <th></th>
                                        <th>Total</th>
                                        <th>Agreed</th>
                                        <th>Disagreed</th>
                                        <th>Unsure</th>
                                    </tr>
                                    <tr>
                                        <th>Overall</th>
                                        <th>@LabelValidationTable.countValidations</th>
                                        <th>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1) * 100.0 / LabelValidationTable.countValidations)))%</th>
                                        <th>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2) * 100.0 / LabelValidationTable.countValidations)))%</th>
                                        <th>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3) * 100.0 / LabelValidationTable.countValidations)))%</th>
                                    </tr>
                                    <tr style="font-size: 90%;">
                                        <td style="padding-left: 30px">@Messages("curb.ramp")</td>
                                        <td>@LabelValidationTable.countValidations("CurbRamp")</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1, "CurbRamp") * 100.0 / LabelValidationTable.countValidations("CurbRamp"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2, "CurbRamp") * 100.0 / LabelValidationTable.countValidations("CurbRamp"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3, "CurbRamp") * 100.0 / LabelValidationTable.countValidations("CurbRamp"))))%</td>
                                    </tr>
                                    <tr style="font-size: 90%;">
                                        <td style="padding-left: 30px">@Messages("missing.ramp")</td>
                                        <td>@LabelValidationTable.countValidations("NoCurbRamp")</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1, "NoCurbRamp") * 100.0 / LabelValidationTable.countValidations("NoCurbRamp"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2, "NoCurbRamp") * 100.0 / LabelValidationTable.countValidations("NoCurbRamp"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3, "NoCurbRamp") * 100.0 / LabelValidationTable.countValidations("NoCurbRamp"))))%</td>
                                    </tr>
                                    <tr style="font-size: 90%;">
                                        <td style="padding-left: 30px">@Messages("obstacle")</td>
                                        <td>@LabelValidationTable.countValidations("Obstacle")</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1, "Obstacle") * 100.0 / LabelValidationTable.countValidations("Obstacle"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2, "Obstacle") * 100.0 / LabelValidationTable.countValidations("Obstacle"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3, "Obstacle") * 100.0 / LabelValidationTable.countValidations("Obstacle"))))%</td>
                                    </tr>
                                    <tr style="font-size: 90%;">
                                        <td style="padding-left: 30px">@Messages("surface.problem")</td>
                                        <td>@LabelValidationTable.countValidations("SurfaceProblem")</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1, "SurfaceProblem") * 100.0 / LabelValidationTable.countValidations("SurfaceProblem"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2, "SurfaceProblem") * 100.0 / LabelValidationTable.countValidations("SurfaceProblem"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3, "SurfaceProblem") * 100.0 / LabelValidationTable.countValidations("SurfaceProblem"))))%</td>
                                    </tr>
                                    <tr style="font-size: 90%;">
                                        <td style="padding-left: 30px">@Messages("no.sidewalk")</td>
                                        <td>@LabelValidationTable.countValidations("NoSidewalk")</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1, "NoSidewalk") * 100.0 / LabelValidationTable.countValidations("NoSidewalk"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2, "NoSidewalk") * 100.0 / LabelValidationTable.countValidations("NoSidewalk"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3, "NoSidewalk") * 100.0 / LabelValidationTable.countValidations("NoSidewalk"))))%</td>
                                    </tr>
                                    <tr style="font-size: 90%;">
                                        <td style="padding-left: 30px">@Messages("crosswalk")</td>
                                        <td>@LabelValidationTable.countValidations("Crosswalk")</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1, "Crosswalk") * 100.0 / LabelValidationTable.countValidations("Crosswalk"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2, "Crosswalk") * 100.0 / LabelValidationTable.countValidations("Crosswalk"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3, "Crosswalk") * 100.0 / LabelValidationTable.countValidations("Crosswalk"))))%</td>
                                    </tr>
                                    <tr style="font-size: 90%;">
                                        <td style="padding-left: 30px">@Messages("signal")</td>
                                        <td>@LabelValidationTable.countValidations("Signal")</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(1, "Signal") * 100.0 / LabelValidationTable.countValidations("Signal"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(2, "Signal") * 100.0 / LabelValidationTable.countValidations("Signal"))))%</td>
                                        <td>@("%.0f".format(DataFormatter.nanToZero(LabelValidationTable.countValidationsByResult(3, "Signal") * 100.0 / LabelValidationTable.countValidations("Signal"))))%</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="tabs-4" class="tab-pane">
                    <div class="row">
                        <h1>Labels</h1>
                        <div class="col-lg-12">
                            <p>Recent labels</p>
                            <table id="label-table" data-order='[[ 1, "desc" ]]' class="table table-striped table-condensed">
                                <thead>
                                <tr>
                                    <th class="col-md-1">Username</th>
                                    <th class="col-md-1" data-class-name="priority">Timestamp</th>
                                    <th class="col-md-1" style="min-width: 100px;">Label Type</th>
                                    <th class="col-md-1">Severity</th>
                                    <th class="col-md-1">Temp?</th>
                                    <th class="col-md-3">Tags</th>
                                    <th class="col-md-2">Description</th>
                                    <th class="col-md-1">Agree</th>
                                    <th class="col-md-1">Disagree</th>
                                    <th class="col-md-1">Unsure</th>
                                    <th class="col-md-1">GSV</th>
                                </tr>
                                </thead>
                                <!-- using this id to locate the labelTags so we can insert the tags-->
                                <tbody id = 'labelRows'>
                                    @LabelTable.getRecentLabelsMetadata(5000).map { label =>
                                        <tr>
                                            <td><a href='@routes.AdminController.userProfile(label.username)'>@label.username</a>
                                            </td>
                                            <td class = 'timestamp'>@label.timestamp</td>
                                            <td>@label.labelTypeKey</td>
                                            <td>@label.severity</td>
                                            <td>@label.temporary</td>
                                            <td>@label.tags.mkString(", ")</td>
                                            <td>@label.description</td>
                                            <td>@label.validations("agree")</td>
                                            <td>@label.validations("disagree")</td>
                                            <td>@label.validations("unsure")</td>
                                            <td>
                                                <a class="labelView" data-label-id="@label.labelId" href="#">View</a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="tabs-5" class="tab-pane">
                    <div class="row">
                        <h1>Users</h1>
                        <div id="user-table-container" class="col-lg-12">
                            <table id="user-table" data-order='[[ 6, "desc" ]]' class="table table-striped table-condensed">
                                <thead>
                                    <tr>
                                        <th class="col-md-1">Username</th>
                                        <th class="col-md-2">User Id</th>
                                        <th class="col-md-1">Email</th>
                                        <th class="col-md-1">Role</th>
                                        <th class="col-md-1">Org</th>
                                        <th class="col-md-1">High Quality</th>
                                        <th class="col-md-1">Label Count</th>
                                        <th class="col-md-1">Own Labels Validated</th>
                                        <th class="col-md-1">%Own Labels Agree</th>
                                        <th class="col-md-1">Others' Labels Validated</th>
                                        <th class="col-md-1">%Others' Labels Agreed</th>
                                        <th class="col-md-2">Date Registered</th>
                                        <th class="col-md-2" data-class-name="priority">Last Login</th>
                                        <th class="col-md-1">Login Count</th>
                                    </tr>
                                </thead>
                                <tbody>
                                @UserDAOSlick.getUserStatsForAdminPage.map { u =>
                                <tr>
                                    <td><a href='@routes.AdminController.userProfile(u.username)'>@u.username</a></td>
                                    <td>@u.userId</td>
                                    <td>@u.email</td>
                                    <td>
                                        @if(u.role != "Owner"){
                                            <div class="dropdown role-dropdown">
                                                <button class="btn btn-default dropdown-toggle" type="button" id="userRoleDropdown@u.userId" data-toggle="dropdown">
                                                    @u.role
                                                    <span class="caret"></span>
                                                </button>
                                                <ul class="dropdown-menu" role="menu" aria-labelledby="userRoleDropdown@u.userId">
                                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#!" class="change-role">Registered</a></li>
                                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#!" class="change-role">Turker</a></li>
                                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#!" class="change-role">Researcher</a></li>
                                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#!" class="change-role">Administrator</a></li>
                                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#!" class="change-role">Anonymous</a></li>
                                                </ul>
                                            </div>
                                        } else {
                                            @u.role
                                        }
                                    </td>
                                    <td>
                                        <div class="dropdown org-dropdown">
                                            <button class="btn btn-default dropdown-toggle" type="button" id="userOrgDropdown@u.userId" data-toggle="dropdown">
                                                @u.org.getOrElse("None")
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu" role="menu" aria-labelledby="userOrgDropdown@u.userId">
                                                @OrganizationTable.getAllTeams.map { org =>
                                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#!" class="change-org" data-org-id="@org.orgId">@org.orgName</a></li>
                                                }
                                                <li role="presentation"><a role="menuitem" tabindex="-1" href="#!" class="change-org" data-org-id="-1">None</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td>@u.highQuality</td>
                                    <td>@u.labels</td>
                                    <td>@u.ownValidated</td>
                                    <td>@("%.0f".format(u.ownValidatedAgreedPct * 100))%</td>
                                    <td>@u.othersValidated</td>
                                    <td>@("%.0f".format(u.othersValidatedAgreedPct * 100))%</td>
                                    <td class = 'timestamp'>@u.signUpTime</td>
                                    <td class = 'timestamp'>@u.lastSignInTime</td>
                                    <td>@u.signInCount</td>
                                </tr>
                                }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="tabs-6" class="tab-pane">
                    <h1>Label Search</h1>
                    <form onSubmit="return false;">
                        <div class="form-group">
                            <label for="form-control-input">Label ID</label>
                            <input type="text" class="form-control" id="form-control-input" placeholder="Enter Label ID here...">
                        </div>
                    </form>
                    <button type="submit" id="submit" class="btn btn-primary">Submit</button>
                </div>
                <div class="tab-pane" id="tabs-7">
                    <h1>Teams</h1>
                    <table id="teams-table" class="table table-striped">
                        <thead>
                            <tr>
                                <th>Team Name</th>
                                <th>Description</th>
                                <th>Open/Closed</th>
                                <th>Visible/Non-Visible</th>
                            </tr>
                        </thead>
                        <tbody id="teams-body">
                            <!-- Teams will be dynamically populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            $('#teams-tab').on('click', function() {
                $.ajax({
                    url: '/userapi/getTeams', 
                    method: 'GET',
                    success: function(data) {
                        $('#teams-body').empty();
        
                        data.sort((a, b) => a.orgName.localeCompare(b.orgName));
                        
                        data.forEach(function(team) {
                            $('#teams-body').append(`
                                <tr>
                                    <td>${team.orgName}</td>
                                    <td>${team.orgDescription}</td>
                                    <td>
                                        <select class="status-select" data-id="${team.orgId}" data-field="isOpen">
                                            <option value="true" ${team.isOpen ? 'selected' : ''}>Open</option>
                                            <option value="false" ${!team.isOpen ? 'selected' : ''}>Closed</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select class="visibility-select" data-id="${team.orgId}" data-field="isVisible">
                                            <option value="true" ${team.isVisible ? 'selected' : ''}>Visible</option>
                                            <option value="false" ${!team.isVisible ? 'selected' : ''}>Non-Visible</option>
                                        </select>
                                    </td>
                                </tr>
                            `);
                        });
        
                        $('.status-select, .visibility-select').on('change', function() {
                            const orgId = $(this).data('id');
                            const isOpen = $(this).closest('tr').find('.status-select').val() === 'true';
                            const isVisible = $(this).closest('tr').find('.visibility-select').val() === 'true';
        
                            $.ajax({
                                url: `/userapi/updateTeam/${orgId}`, 
                                method: 'POST',
                                contentType: 'application/json',
                                data: JSON.stringify({ isOpen, isVisible }),
                                success: function(response) {
                                    console.log('Update successful:', response);
                                },
                                error: function(xhr, status, error) {
                                    console.error('Error updating team:', error);
                                }
                            });
                        });
                    },
                    error: function(xhr, status, error) {
                        console.error('Error fetching teams:', error);
                    }
                });
            });
        });
    </script>   
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/d3-3.5.6.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/Admin/build/Admin.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/PSMap/build/PSMap.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/turf-7.1.0.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/jquery.dataTables.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/dataTables.bootstrap.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/SVValidate/src/util/PanoProperties.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/common/timestampLocalization.js")'></script>
    <script type="text/javascript">
        updateTimestamps("@lang.code");
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega/3.0.0-beta.33/vega.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-lite/2.0.0-beta.4/vega-lite.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vega-embed/3.0.0-beta.17/vega-embed.js"></script>

    <script src='@routes.Assets.at("javascripts/lib/mapbox-gl-3.6.0.js")'></script>
    <script src='@routes.Assets.at("javascripts/lib/mapbox-gl-language-1.0.1.js")'></script>
    <link href='@routes.Assets.at("javascripts/lib/mapbox-gl-3.6.0.css")' rel="stylesheet"/>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/i18next-23.14.0.min.js")'></script>
    <script type="text/javascript" src='@routes.Assets.at("javascripts/lib/i18nextHttpBackend-2.6.0.min.js")'></script>

    <link href='@routes.Assets.at("stylesheets/dataTables.bootstrap.min.css")' rel="stylesheet"/>
    <link href='@routes.Assets.at("stylesheets/choropleth.css")' rel="stylesheet"/>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link href='@routes.Assets.at("stylesheets/admin.css")' rel="stylesheet"/>

    <script>
        $(document).ready(function () {
            // Gets all translations before loading the choropleths.
            i18next.use(i18nextHttpBackend).init({
                backend: { loadPath: '/assets/locales/{{lng}}/{{ns}}.json' },
                fallbackLng: 'en',
                ns: ['common', 'labelmap'],
                defaultNS: 'common',
                lng: '@lang.code',
                debug: false
            }, function(err, t) {
                window.admin = Admin(_, $);

                $('#comments-table').dataTable();
                $('#label-table').dataTable();
                $('#user-table').dataTable();
                $('#tabs').tabs().addClass('ui-tabs-vertical ui-helper-clearfix');
                $('#tabs li').removeClass('ui-corner-top').addClass('ui-corner-left');
            });


            // Initialize the sliders in the legend. We add the "change" functionality after the map loads.
            $( "*[id*='slider']" ).each(function() {
                $(this).slider({ range: true, min : 0, max : 5, step: 1, values: [0,5], disabled: true });
            });

            console.log("To add data from users marked as 'low quality'', use the following commands. You can run them again with 'false' to remove.");
            console.log("admin.mapData.lowQualityUsers = true;");
            console.log("filterLabelLayers('', admin.map, admin.mapData);");
        });
    </script>
}
