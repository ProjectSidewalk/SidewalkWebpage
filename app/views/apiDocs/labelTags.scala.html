@(activePage: String = "label-tags")(implicit request: RequestHeader, assets: AssetsFinder)

@content = {
<div class="api-section" id="label-tags-intro-section">
  <h1 class="api-heading" id="label-tags-api">Label Tags API <a href="#label-tags-api" class="permalink">#</a></h1> 
  <p>
    The Label Tags API provides a comprehensive list of tags that can be applied to different types of accessibility labels in Project Sidewalk.
    Each tag represents a specific characteristic or feature of a label, allowing for more detailed classification of accessibility issues.
  </p>
  <p>
    This endpoint is useful for applications that want to implement detailed filtering of accessibility data,
    display tag information alongside labels, or understand the classification system used in Project Sidewalk's labeling scheme.
  </p>
</div>

<div class="api-section" id="visual-example-section">
  <h2 class="api-heading" id="visual-example">Label Tags API Preview <a href="#visual-example" class="permalink">#</a></h2>
  <p>Below is a live preview of the label tags grouped by label type, retrieved directly from the API:</p>
  
  <div id="label-tags-preview">Loading label tags data...</div>
  
  <link rel="stylesheet" href="@assets.path("stylesheets/api-docs/label-tags.css")">
  <script src="@routes.Assets.versioned("javascripts/api-docs/label-tags-preview.js")"></script>
  <script>
    // Initialize the label tags preview
    document.addEventListener('DOMContentLoaded', function() {
      LabelTagsPreview.setup({
        maxWidth: 1000
      }).init();
    });
  </script>
</div>

<div class="api-section" id="endpoint-section">
  <h2 class="api-heading" id="endpoint">Endpoint <a href="#endpoint" class="permalink">#</a></h2> 
  <p>Retrieve a list of all label tags with their metadata.</p>
  <p><code>GET /v3/api/labelTags</code></p>
  <p><strong>Base URL:</strong> <code>https://api.projectsidewalk.org/v3</code></p>
</div>

<div class="api-section" id="responses-section">
  <h2 class="api-heading" id="responses">Responses<a href="#responses" class="permalink">#</a></h2> 

  <h3 class="api-heading" id="success-response-200-ok">Success Response (200 OK)<a href="#success-response-200-ok" class="permalink">#</a></h3> 
  <p>
      On success, the API returns an HTTP <code>200 OK</code> status code and a JSON object containing an array of label tags.
  </p>

  <pre><code class="language-json">
    {
      "status": "OK",
      "labelTags": [
        {
          "id": 1,
          "labelType": "CurbRamp",
          "tag": "narrow",
          "mutuallyExclusiveWith": []
        },
        {
          "id": 3,
          "labelType": "CurbRamp",
          "tag": "missing tactile warning",
          "mutuallyExclusiveWith": [
            "tactile warning"
          ]
        },
        // ... more label tags
      ]
    }
  </code></pre>

  <h4 id="response-fields">Response Fields <a href="#response-fields" class="permalink">#</a></h4>
  <div class="api-table-wrapper">
    <table class="api-table">
      <thead>
        <tr>
          <th>Field</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>status</code></td>
          <td><code>string</code></td>
          <td>Always "OK" for successful responses.</td>
        </tr>
        <tr>
          <td><code>labelTags</code></td>
          <td><code>array</code></td>
          <td>Array of label tag objects.</td>
        </tr>
        <tr>
          <td><code>labelTags[].id</code></td>
          <td><code>integer</code></td>
          <td>Unique identifier for the tag.</td>
        </tr>
        <tr>
          <td><code>labelTags[].labelType</code></td>
          <td><code>string</code></td>
          <td>The label type this tag applies to (e.g., "CurbRamp", "Obstacle").</td>
        </tr>
        <tr>
          <td><code>labelTags[].tag</code></td>
          <td><code>string</code></td>
          <td>Name of the tag (e.g., "narrow", "missing tactile warning").</td>
        </tr>
        <tr>
          <td><code>labelTags[].mutuallyExclusiveWith</code></td>
          <td><code>array</code></td>
          <td>Array of tag names that cannot be applied simultaneously with this tag.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3 class="api-heading" id="error-responses">Error Responses<a href="#error-responses" class="permalink">#</a></h3> 
  <p>If an error occurs, the API will return an appropriate HTTP status code and a JSON response body containing details about the error.</p>
  <ul>
    <li><strong><code>500 Internal Server Error</code>:</strong> An unexpected error occurred on the server.</li>
    <li><strong><code>503 Service Unavailable</code>:</strong> The server is temporarily unable to handle the request (e.g., during maintenance).</li>
  </ul>

  <h4 id="error-body">Error Response Body <a href="#error-body" class="permalink">#</a></h4>
  <p>Error responses include a JSON body with the following structure:</p>
  <pre><code class="language-json">
{
  "status": 500, // HTTP Status Code
  "code": "INTERNAL_SERVER_ERROR", // Machine-readable error code
  "message": "Failed to retrieve label tags: Database connection error" // Human-readable description
}
  </code></pre>
</div>

<div class="api-section" id="example-requests-section">
  <h3 class="api-heading" id="example-requests">Example Requests <a href="#example-requests" class="permalink">#</a></h3> 

  <h4 class="api-heading" id="curl-example">Curl Example <a href="#curl-example" class="permalink">#</a></h4> 
  <pre><code class="language-bash">
curl "https://api.projectsidewalk.org/v3/labelTags"
  </code></pre>

  <h4 class="api-heading" id="python-example">Python Example <a href="#python-example" class="permalink">#</a></h4> 
  <pre><code class="language-python">
import requests

BASE_URL = "https://api.projectsidewalk.org/v3"

response = requests.get(f"{BASE_URL}/labelTags")
if response.status_code == 200:
    label_tags = response.json()["labelTags"]
    print(f"Found {len(label_tags)} label tags:")
    
    # Group tags by label type
    grouped_tags = {}
    for tag in label_tags:
        label_type = tag["labelType"]
        if label_type not in grouped_tags:
            grouped_tags[label_type] = []
        grouped_tags[label_type].append(tag)
    
    # Print tags by label type
    for label_type, tags in grouped_tags.items():
        print(f"\n{label_type} tags ({len(tags)}):")
        for tag in tags:
            exclusions = ", ".join(tag["mutuallyExclusiveWith"]) if tag["mutuallyExclusiveWith"] else "None"
            print(f"- {tag['tag']} (Mutually exclusive with: {exclusions})")
else:
    print(f"Error: {response.status_code} - {response.text}")
  </code></pre>

  <h4 class="api-heading" id="javascript-example">JavaScript Example <a href="#javascript-example" class="permalink">#</a></h4> 
  <pre><code class="language-javascript">
const BASE_URL = "https://api.projectsidewalk.org/v3";

fetch(`${BASE_URL}/labelTags`)
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }
    return response.json();
  })
  .then(data => {
    console.log(`Found ${data.labelTags.length} label tags`);
    
    // Group tags by label type
    const groupedTags = data.labelTags.reduce((groups, tag) => {
      const labelType = tag.labelType;
      if (!groups[labelType]) {
        groups[labelType] = [];
      }
      groups[labelType].push(tag);
      return groups;
    }, {});
    
    // Log tags by label type
    Object.entries(groupedTags).forEach(([labelType, tags]) => {
      console.log(`\n${labelType} tags (${tags.length}):`);
      tags.forEach(tag => {
        const exclusions = tag.mutuallyExclusiveWith.length > 0 
          ? tag.mutuallyExclusiveWith.join(", ") 
          : "None";
        console.log(`- ${tag.tag} (Mutually exclusive with: ${exclusions})`);
      });
    });
  })
  .catch(error => {
    console.error('Error fetching label tags:', error);
  });
  </code></pre>
</div>

}

@apiDocs.layout(activePage)(content)