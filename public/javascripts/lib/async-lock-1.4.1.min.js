/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/async-lock@1.4.1/lib/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var AsyncLock=function(e){if(e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.domainReentrant){if("undefined"==typeof process||void 0===process.domain)throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=e.timeout||AsyncLock.DEFAULT_TIMEOUT,this.maxOccupationTime=e.maxOccupationTime||AsyncLock.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=e.maxExecutionTime||AsyncLock.DEFAULT_MAX_EXECUTION_TIME,e.maxPending===1/0||Number.isInteger(e.maxPending)&&e.maxPending>=0?this.maxPending=e.maxPending:this.maxPending=AsyncLock.DEFAULT_MAX_PENDING};AsyncLock.DEFAULT_TIMEOUT=0,AsyncLock.DEFAULT_MAX_OCCUPATION_TIME=0,AsyncLock.DEFAULT_MAX_EXECUTION_TIME=0,AsyncLock.DEFAULT_MAX_PENDING=1e3,AsyncLock.prototype.acquire=function(e,n,t,i){if(Array.isArray(e))return this._acquireBatch(e,n,t,i);if("function"!=typeof n)throw new Error("You must pass a function to execute");var o=null,u=null,s=null;"function"!=typeof t&&(i=t,t=null,s=new this.Promise((function(e,n){o=e,u=n}))),i=i||{};var r=!1,c=null,a=null,m=null,l=this,f=function(n,i,c){a&&(clearTimeout(a),a=null),m&&(clearTimeout(m),m=null),n&&(l.queues[e]&&0===l.queues[e].length&&delete l.queues[e],l.domainReentrant&&delete l.domains[e]),r||(s?i?u(i):o(c):"function"==typeof t&&t(i,c),r=!0),n&&l.queues[e]&&l.queues[e].length>0&&l.queues[e].shift()()},d=function(t){if(r)return f(t);c&&(clearTimeout(c),c=null),l.domainReentrant&&t&&(l.domains[e]=process.domain);var o=i.maxExecutionTime||l.maxExecutionTime;if(o&&(m=setTimeout((function(){l.queues[e]&&f(t,new Error("Maximum execution time is exceeded "+e))}),o)),1===n.length){var u=!1;try{n((function(e,n){u||(u=!0,f(t,e,n))}))}catch(e){u||(u=!0,f(t,e))}}else l._promiseTry((function(){return n()})).then((function(e){f(t,void 0,e)}),(function(e){f(t,e)}))};l.domainReentrant&&process.domain&&(d=process.domain.bind(d));var p=i.maxPending||l.maxPending;if(l.queues[e])if(l.domainReentrant&&process.domain&&process.domain===l.domains[e])d(!1);else if(l.queues[e].length>=p)f(!1,new Error("Too many pending tasks in queue "+e));else{var h=function(){d(!0)};i.skipQueue?l.queues[e].unshift(h):l.queues[e].push(h);var T=i.timeout||l.timeout;T&&(c=setTimeout((function(){c=null,f(!1,new Error("async-lock timed out in queue "+e))}),T))}else l.queues[e]=[],d(!0);var y=i.maxOccupationTime||l.maxOccupationTime;return y&&(a=setTimeout((function(){l.queues[e]&&f(!1,new Error("Maximum occupation time is exceeded in queue "+e))}),y)),s||void 0},AsyncLock.prototype._acquireBatch=function(e,n,t,i){"function"!=typeof t&&(i=t,t=null);var o=this,u=e.reduceRight((function(e,n){return function(e,n){return function(t){o.acquire(e,n,t,i)}}(n,e)}),n);if("function"!=typeof t)return new this.Promise((function(e,n){1===u.length?u((function(t,i){t?n(t):e(i)})):e(u())}));u(t)},AsyncLock.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0},AsyncLock.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(e){return this.Promise.reject(e)}};
//# sourceMappingURL=/sm/252dfe8a29e58951bedc720e2770dac5ed94a499531436017e619d0b6b1c3bea.map